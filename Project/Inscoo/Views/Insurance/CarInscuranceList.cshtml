@model IEnumerable<Models.vCarInsuranceList>
<table class="table table-bordered">
    <tr style="background-color:#24A9E4;color:#fff;">
        <th>
            文件名
        </th>
        <th>
            上传时间
        </th>
        <th>
            上传人
        </th>
        <th>
            操作
        </th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.ExcelName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ExceCreateTime)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ExceCreateUser)
            </td>


            <td>
                <a href="@item.ExceUrl" target="blank">下载</a>
                @if (ViewBag.CanEdit && string.IsNullOrEmpty(item.EinsuranceUrl))
                {
                    <span>|</span>
                    @Html.ActionLink("更新", "CarInscuranceCreate", new { ExcelId = item.ExcelId })
                    <span>|</span>
                    @Html.ActionLink("删除", "CarInscuranceDelete", new { ExcelId = item.ExcelId })
                }
                else
                {
                    if (string.IsNullOrEmpty(item.EinsuranceUrl))
                    {
                        <span>|</span>
                        @Html.ActionLink("上传电子保单", "CarInscuranceUploadEinsurance", new { insuranceId = item.InsuranceId })
                    }
                    else
                    {
                        <span>|</span>
                        <a href="@item.EinsuranceUrl" target="blank">电子保单</a>
                    }
                }

            </td>



        </tr>
    }
</table>
@{
    PageCommand command = ViewBag.pageCommand;
    @Html.Pager(command)
}
